---
import BaseLayout from '../../layouts/BaseLayout.astro';
import BlogCard from '../../components/BlogCard.astro';

const postFiles = import.meta.glob('../../content/blog/*.md', { eager: true });

const posts = Object.entries(postFiles)
  .map(([path, mod]: [string, any]) => ({
    ...mod.frontmatter,
    slug: path.split('/').pop()!.replace('.md', ''),
  }))
  .sort((a, b) => new Date(b.pubDate).getTime() - new Date(a.pubDate).getTime());
---

<BaseLayout pageTitle="Blog" description="Writing about software engineering, Go, and distributed systems.">
  <div class="page-header">
    <h1>Blog</h1>
    <p>Writing about Go, distributed systems, and software engineering.</p>
  </div>

  <div class="cards-grid">
    {posts.map((post: any) => (
      <BlogCard
        title={post.title}
        description={post.description}
        pubDate={post.pubDate}
        tags={post.tags}
        slug={post.slug}
        author={post.author}
      />
    ))}
  </div>
</BaseLayout>
